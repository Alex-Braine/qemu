34a35
> #include "afunix.h"
88c89
<     case PF_UNIX:  return NETWORK_ADDRESS_FAMILY_UNIX;
---
>     case AF_UNIX:  return NETWORK_ADDRESS_FAMILY_UNIX;
377a379
>         printf("conecting\n");
384c386,388
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         qemu_log("[inet_connect_addr] Failed to connect");
>         sleep(600);
>         error_setg_errno(errp, errno, "x[inet_connect_addr] Failed to connect to '%s:%s'",
579c583
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         error_setg_errno(errp, errno, "[inet_dgram_saddr] Failed to connect to '%s:%s'",
785c789
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         error_setg_errno(errp, errno, "[vsock_connect_addr] Failed to connect to '%s:%s'",
884,885d887
< #ifndef _WIN32
< 
916c918
<     sock = qemu_socket(PF_UNIX, SOCK_STREAM, 0);
---
>     sock = qemu_socket(AF_UNIX, SOCK_STREAM, 0);
1008c1010
<     sock = qemu_socket(PF_UNIX, SOCK_STREAM, 0);
---
>     sock = socket(AF_UNIX, SOCK_STREAM, 0);
1024d1025
<     memset(&un, 0, sizeof(un));
1027,1036c1028
< 
<     if (abstract) {
<         un.sun_path[0] = '\0';
<         memcpy(&un.sun_path[1], saddr->path, pathlen);
<         if (saddr_is_tight(saddr)) {
<             addrlen = offsetof(struct sockaddr_un, sun_path) + 1 + pathlen;
<         }
<     } else {
<         memcpy(un.sun_path, saddr->path, pathlen);
<     }
---
>     strncpy(un.sun_path, saddr->path, pathlen);
1039a1032,1033
>         qemu_log("[unix_connect_saddr] conecting");
>         printf("[unix_connect_saddr] conecting\n");
1046c1040,1042
<         error_setg_errno(errp, -rc, "Failed to connect to '%s'",
---
>         qemu_log("[unix_connect_saddr] Failed to connect");
>         sleep(600);
>         error_setg_errno(errp, -rc, "x[unix_connect_saddr] Failed to connect to '%s'",
1058,1076d1053
< #else
< 
< static int unix_listen_saddr(UnixSocketAddress *saddr,
<                              int num,
<                              Error **errp)
< {
<     error_setg(errp, "unix sockets are not available on windows");
<     errno = ENOTSUP;
<     return -1;
< }
< 
< static int unix_connect_saddr(UnixSocketAddress *saddr, Error **errp)
< {
<     error_setg(errp, "unix sockets are not available on windows");
<     errno = ENOTSUP;
<     return -1;
< }
< #endif
< 
1096a1074
>     printf("[unix_connect]\n");
1195a1174
>         printf("[socket_connect]\n");
1339d1317
< #ifndef WIN32
1366d1343
< #endif /* WIN32 */
1398d1374
< #ifndef WIN32
1401d1376
< #endif /* WIN32 */
