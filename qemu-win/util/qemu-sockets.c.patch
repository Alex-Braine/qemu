34a35
> #include "afunix.h"
88c89
<     case PF_UNIX:  return NETWORK_ADDRESS_FAMILY_UNIX;
---
>     case AF_UNIX:  return NETWORK_ADDRESS_FAMILY_UNIX;
377a379
>         printf("conecting\n");
384c386
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         error_setg_errno(errp, errno, "[inet_connect_addr] Failed to connect to '%s:%s'",
579c581
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         error_setg_errno(errp, errno, "[inet_dgram_saddr] Failed to connect to '%s:%s'",
785c787
<         error_setg_errno(errp, errno, "Failed to connect to '%s:%s'",
---
>         error_setg_errno(errp, errno, "[vsock_connect_addr] Failed to connect to '%s:%s'",
884,885d885
< #ifndef _WIN32
< 
916c916
<     sock = qemu_socket(PF_UNIX, SOCK_STREAM, 0);
---
>     sock = qemu_socket(AF_UNIX, SOCK_STREAM, 0);
1008c1008
<     sock = qemu_socket(PF_UNIX, SOCK_STREAM, 0);
---
>     sock = socket(AF_UNIX, SOCK_STREAM, 0);
1024d1023
<     memset(&un, 0, sizeof(un));
1027,1036c1026
< 
<     if (abstract) {
<         un.sun_path[0] = '\0';
<         memcpy(&un.sun_path[1], saddr->path, pathlen);
<         if (saddr_is_tight(saddr)) {
<             addrlen = offsetof(struct sockaddr_un, sun_path) + 1 + pathlen;
<         }
<     } else {
<         memcpy(un.sun_path, saddr->path, pathlen);
<     }
---
>     strncpy(un.sun_path, saddr->path, pathlen);
1039a1030
>         printf("[unix_connect_saddr] conecting\n");
1046c1037
<         error_setg_errno(errp, -rc, "Failed to connect to '%s'",
---
>         error_setg_errno(errp, -rc, "[unix_connect_saddr] Failed to connect to '%s'",
1058,1076d1048
< #else
< 
< static int unix_listen_saddr(UnixSocketAddress *saddr,
<                              int num,
<                              Error **errp)
< {
<     error_setg(errp, "unix sockets are not available on windows");
<     errno = ENOTSUP;
<     return -1;
< }
< 
< static int unix_connect_saddr(UnixSocketAddress *saddr, Error **errp)
< {
<     error_setg(errp, "unix sockets are not available on windows");
<     errno = ENOTSUP;
<     return -1;
< }
< #endif
< 
1096a1069
>     printf("[unix_connect]\n");
1195a1169
>         printf("[socket_connect]\n");
1339d1312
< #ifndef WIN32
1366d1338
< #endif /* WIN32 */
1398d1369
< #ifndef WIN32
1401d1371
< #endif /* WIN32 */
